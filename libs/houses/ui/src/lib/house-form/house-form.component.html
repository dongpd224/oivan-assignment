<mat-card class="house-form-card">
  <mat-card-header class="d-flex justify-content-between align-items-center w-100">
    <mat-card-title>
      {{ isEditMode ? 'House Number: ' + houseForm.controls['houseNumber']?.value : '' }}
    </mat-card-title>

    <div>
      <button 
        mat-raised-button 
        color="primary" 
        type="button"
        [disabled]="houseForm.invalid || isSubmitting()"
        (click)="onSubmit()">
        <mat-icon>{{ isEditMode ? 'save' : 'add' }}</mat-icon>
        {{ isSubmitting() ? 'Saving...' : (isEditMode ? 'Update House' : 'Create House') }}
      </button>
    </div>
  </mat-card-header>

  <mat-card-content class="mt-4">
    <form [formGroup]="houseForm">
      <div class="row gy-3">
        <div class="col-12 col-md-6 col-lg-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>House Number</mat-label>
            <input matInput formControlName="houseNumber" placeholder="e.g., H-001">
            @if (houseForm.get('houseNumber')?.hasError('required')) {
              <mat-error>House number is required</mat-error>
            }
            @if (houseForm.get('houseNumber')?.hasError('duplicate')) {
              <mat-error>House number already exists</mat-error>
            }
          </mat-form-field>
        </div>

        <div class="col-12 col-md-6 col-lg-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Block Number</mat-label>
            <input matInput formControlName="blockNumber" placeholder="e.g., A">
            @if (houseForm.get('blockNumber')?.hasError('required')) {
              <mat-error>Block number is required</mat-error>
            }
          </mat-form-field>
        </div>

        <div class="col-12 col-md-6 col-lg-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Land Number</mat-label>
            <input matInput formControlName="landNumber" placeholder="e.g., 01">
            @if (houseForm.get('landNumber')?.hasError('required')) {
              <mat-error>Land number is required</mat-error>
            }
          </mat-form-field>
        </div>

        <div class="col-12 col-md-6 col-lg-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>House Type</mat-label>
            <mat-select formControlName="houseType">
              @for (option of houseTypeOptions; track option.value) {
                <mat-option [value]="option.value">{{ option.label }}</mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>

        <div class="col-12 col-md-6 col-lg-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>House Model</mat-label>
            <mat-select formControlName="model">
              @for (model of models(); track model) {
                <mat-option [value]="model">{{ model }}</mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>

        <div class="col-12 col-md-6 col-lg-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Price</mat-label>
            <input matInput formControlName="price" libInputCurrency>
            @if (houseForm.get('price')?.hasError('required')) {
              <mat-error>Price is required</mat-error>
            }
            @if (houseForm.get('price')?.hasError('min')) {
              <mat-error>Price must be greater than 0</mat-error>
            }
          </mat-form-field>
        </div>

        <div class="col-12 col-md-6 col-lg-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Status</mat-label>
            <mat-select formControlName="status">
              @for (option of statusOptions; track option.value) {
                <mat-option [value]="option.value">{{ option.label }}</mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>
      </div>
    </form>
  </mat-card-content>
</mat-card>
